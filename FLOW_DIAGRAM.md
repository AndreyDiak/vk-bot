# Диаграмма потока: Регистрация с названием команды и изменение количества участников

## Новый поток регистрации с названием команды

```
Выбор мероприятия
       ↓
[Нажатие "Зарегистрироваться"]
       ↓
Выбор количества участников
┌─────────────────┐
│ 1  2  3         │
│ 4  5  6         │
│ 7  8  9         │
│ 10              │
│ 🔙 Назад        │
└─────────────────┘
       ↓
[Выбор количества]
       ↓
Ввод названия команды
┌─────────────────┐
│ ⏭️ Пропустить   │
│ 🔙 Назад        │
└─────────────────┘
       ↓
[Ввод названия или "Пропустить"]
       ↓
Подтверждение регистрации
┌─────────────────┐
│ ✅ Да, зарегистрироваться │
│ ❌ Отмена       │
└─────────────────┘
       ↓
[Подтверждение]
       ↓
Регистрация в базе данных
       ↓
Сообщение об успехе
```

## Поток для зарегистрированных пользователей

```
Пользователь зарегистрирован на мероприятие
           ↓
    Детали мероприятия
           ↓
    ┌─────────────────┐
    │ ✏️ Изменить     │
    │ ❌ Отменить     │
    │ 🔙 К мероприятиям│
    └─────────────────┘
           ↓
    [Нажатие "Изменить количество"]
           ↓
    Выбор количества участников
    ┌─────────────────┐
    │ 1  2  3         │
    │ 4  5  6         │
    │ 7  8  9         │
    │ 10              │
    │ 🔙 Назад        │
    └─────────────────┘
           ↓
    [Выбор количества]
           ↓
    Подтверждение изменения
    ┌─────────────────┐
    │ ✅ Да, изменить │
    │ ❌ Отмена       │
    └─────────────────┘
           ↓
    [Подтверждение]
           ↓
    Обновление в базе данных
           ↓
    Сообщение об успехе
```

## Команды и состояния

### Новые команды:
- `confirm_register_with_team` - подтвердить регистрацию с названием команды
- `change_participants` - начать изменение количества участников
- `confirm_change_participants` - подтвердить изменение количества

### Новые состояния пользователя:
- `entering_team_name` - пользователь вводит название команды
- `changing_participants` - пользователь выбирает новое количество участников

### Обновленные методы:
- `showTeamNameInput()` - новый метод для ввода названия команды
- `handleTeamNameInput()` - обработка ввода названия команды
- `showRegistrationConfirm()` - добавлен параметр `teamName`
- `registerUser()` - добавлен параметр `teamName`
- `showParticipantsCountSelection()` - добавлен параметр `isChanging`
- `handleParticipantsCount()` - поддержка режима изменения
- `getEventDetails()` - новая кнопка для зарегистрированных пользователей
- `getParticipantsCountKeyboard()` - поддержка разных команд

## Проверки и ограничения

1. **Валидация названия команды**: Максимум 50 символов
2. **Проверка регистрации**: Пользователь должен быть зарегистрирован на мероприятие
3. **Проверка доступности мест**: Новое количество не должно превышать лимит мероприятия
4. **Валидация количества**: От 1 до 10 участников
5. **Обновление базы данных**: Корректное обновление полей `participants_count` и `team_name`
6. **Название команды необязательно**: Можно пропустить ввод команды
